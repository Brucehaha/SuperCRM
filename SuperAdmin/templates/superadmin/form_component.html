{% load list_display %}
    <form method="post" onsubmit="SelectOption()">{% csrf_token %}
    {{ form.errors }}
    {% if not admin_class.form_add %}
    {% for field_name in admin_class.readonly_fields %}
        <div class="form-group">
        <label for="id_{{ field_name }}">{{ field_name|title }}</label>
        <input class="form-control" disabled id= "id_{{ field_name }}" value="{% get_readonly_value form field_name %}"/>

    {% endfor %}
   {% endif %}

    {% for field in form %}

        <div class="form-group">
        <label for="id_{{ field.name }}">{{ field.label }}</label>
            {% render_form_field field as f %}
            {% if f == "SelectMultiple" %}
                <div class="row">

                <div class="col-lg-5">
                    <select id="id_{{ field.name }}_from" multiple class="form-control">
                        {% get_m2m_avalaible_data field.name form admin_class as avl_data %}
                        {% for v in avl_data %}
                          <option ondblclick="MoveOption(this, 'id_{{ field.name }}_to')" value="{{ v.id }}">{{ v }}</option>
                        {% endfor %}

                    </select>
                </div>
                <div class="col-lg-5">
                    <select tag="selected_value" name="{{ field.name }}" id="id_{{ field.name }}_to" multiple class="form-control">
                    {% get_selected_m2m_data field.name form admin_class as selected_data %}
                     {% for v in selected_data %}
                      <option ondblclick="MoveOption(this, 'id_{{ field.name }}_from')"  value="{{ v.id }}">{{ v }}</option>
                    {% endfor %}
                    </select>
                </div>
                </div>
            {% else %}

             {{ field }}
            {% endif %}
        </div>
    {% endfor %}

  <div class="form-group">
    <div class="col-sm-offset-11 col-sm-2">
      <button type="submit" class="btn btn-info">Save</button>
    </div>
  </div>
    </form>

    <script>
        function MoveOption(that, id) {
            var to_parent_id = $(that).parent().attr('id');
            console.log(to_parent_id)
            var option = "<option value='" + $(that).val() +"'ondblclick=MoveOption(this,'"+ to_parent_id +"') >" + $(that).text() +"</option>";
            $('#'+ id).append(option);
            $(that).remove();
        }
        function SelectOption() {
            $("select[tag] option").prop('selected', true);
        }
    </script>
